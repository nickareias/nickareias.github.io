<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Comparing Clustering on a Labelled Dataset</title>
        <link rel="stylesheet" href="./theme/css/main.css" />
        <link href="nickareias.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Data Science and Machine Learning Atom Feed" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="./">Data Science and Machine Learning </a></h1>
                <nav><ul>
                    <li class="active"><a href="./category/clustering.html">Clustering</a></li>
                    <li><a href="./category/computer-vision.html">Computer Vision</a></li>
                    <li><a href="./category/misc.html">Misc</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="./clustering-car-eval.html" rel="bookmark"
           title="Permalink to Comparing Clustering on a Labelled Dataset">Comparing Clustering on a Labelled Dataset</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-03-21T00:53:00-07:00">
                Published: Tue 21 March 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="./author/nick-areias.html">Nick Areias</a>
        </address>
<p>In <a href="./category/clustering.html">Clustering</a>.</p>
<p>tags: <a href="./tag/python-clustering-sklearn.html">python clustering sklearn</a> </p>
</footer><!-- /.post-info -->      <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
@-moz-document url-prefix() {
  div.inner_cell {
    overflow-x: hidden;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Clustering">Clustering<a class="anchor-link" href="#Clustering">¶</a></h1><p>We are going to look at a dataset of car acceptability.  This dataset consists of 6 attributes that describe a car, and a class describing wether or not the car is acceptable.  We will try to cluster this dataset into 4 clusters without looking at class (acc).  We will then compare the clustering to the pre-existing class values and see if they match up.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [59]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"http://archive.ics.uci.edu/ml/machine-learning-databases/car/car.data"</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s2">"price"</span><span class="p">,</span><span class="s2">"maint"</span><span class="p">,</span><span class="s2">"doors"</span><span class="p">,</span><span class="s2">"ppl"</span><span class="p">,</span><span class="s2">"lug"</span><span class="p">,</span><span class="s2">"safe"</span><span class="p">,</span><span class="s2">"acc"</span><span class="p">))</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[59]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>price</th>
<th>maint</th>
<th>doors</th>
<th>ppl</th>
<th>lug</th>
<th>safe</th>
<th>acc</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>small</td>
<td>low</td>
<td>unacc</td>
</tr>
<tr>
<th>1</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>small</td>
<td>med</td>
<td>unacc</td>
</tr>
<tr>
<th>2</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>small</td>
<td>high</td>
<td>unacc</td>
</tr>
<tr>
<th>3</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>med</td>
<td>low</td>
<td>unacc</td>
</tr>
<tr>
<th>4</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>med</td>
<td>med</td>
<td>unacc</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we will create another dataframe that contains everything from the dataset except the class column.  We do this so we can encode the dataset with dummy variables.  Categorical data is not usefull for machine learning algorithms so we must change it to numerical data.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [60]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_noclass</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">"price"</span><span class="p">,</span><span class="s2">"maint"</span><span class="p">,</span><span class="s2">"doors"</span><span class="p">,</span><span class="s2">"ppl"</span><span class="p">,</span><span class="s2">"lug"</span><span class="p">,</span><span class="s2">"safe"</span><span class="p">]]</span>    <span class="c1">#get every attribute except for class (acc)</span>
<span class="n">data_noclass</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[60]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>price</th>
<th>maint</th>
<th>doors</th>
<th>ppl</th>
<th>lug</th>
<th>safe</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>small</td>
<td>low</td>
</tr>
<tr>
<th>1</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>small</td>
<td>med</td>
</tr>
<tr>
<th>2</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>small</td>
<td>high</td>
</tr>
<tr>
<th>3</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>med</td>
<td>low</td>
</tr>
<tr>
<th>4</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>med</td>
<td>med</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will use one-hot encoding to turn the different values for each attribute into dummy variables.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [61]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">onehot_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data_noclass</span><span class="p">)</span>
<span class="n">onehot_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[61]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>price_high</th>
<th>price_low</th>
<th>price_med</th>
<th>price_vhigh</th>
<th>maint_high</th>
<th>maint_low</th>
<th>maint_med</th>
<th>maint_vhigh</th>
<th>doors_2</th>
<th>doors_3</th>
<th>...</th>
<th>doors_5more</th>
<th>ppl_2</th>
<th>ppl_4</th>
<th>ppl_more</th>
<th>lug_big</th>
<th>lug_med</th>
<th>lug_small</th>
<th>safe_high</th>
<th>safe_low</th>
<th>safe_med</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<th>2</th>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>3</th>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<th>4</th>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Lets load sklearn library for KMeans clustering and see how this dataset is clustered.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [62]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import the kmeans clustering model.</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="k">import</span> <span class="n">KMeans</span>

<span class="c1"># Initialize the model with 2 parameters -- number of clusters and random state.</span>
<span class="n">kmeans_model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Fit the model using the good columns.</span>
<span class="n">kmeans_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">onehot_data</span><span class="p">)</span>
<span class="c1"># Get the cluster assignments.</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">kmeans_model</span><span class="o">.</span><span class="n">labels_</span>

<span class="n">labels</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[62]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array([0, 0, 0, ..., 1, 1, 1])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have our labels, now we want to compare them to the existing classes to see how close our clusters are.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [63]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">'cluster'</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[63]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>price</th>
<th>maint</th>
<th>doors</th>
<th>ppl</th>
<th>lug</th>
<th>safe</th>
<th>acc</th>
<th>cluster</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>small</td>
<td>low</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>small</td>
<td>med</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>2</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>small</td>
<td>high</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>3</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>med</td>
<td>low</td>
<td>unacc</td>
<td>3</td>
</tr>
<tr>
<th>4</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>med</td>
<td>med</td>
<td>unacc</td>
<td>3</td>
</tr>
<tr>
<th>5</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>med</td>
<td>high</td>
<td>unacc</td>
<td>3</td>
</tr>
<tr>
<th>6</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>big</td>
<td>low</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>7</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>big</td>
<td>med</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>8</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>big</td>
<td>high</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>9</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>4</td>
<td>small</td>
<td>low</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>10</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>4</td>
<td>small</td>
<td>med</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>11</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>4</td>
<td>small</td>
<td>high</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>12</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>4</td>
<td>med</td>
<td>low</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>13</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>4</td>
<td>med</td>
<td>med</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>14</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>4</td>
<td>med</td>
<td>high</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>15</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>4</td>
<td>big</td>
<td>low</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>16</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>4</td>
<td>big</td>
<td>med</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>17</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>4</td>
<td>big</td>
<td>high</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>18</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>small</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>19</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>small</td>
<td>med</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>20</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>small</td>
<td>high</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>21</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>med</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>22</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>med</td>
<td>med</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>23</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>med</td>
<td>high</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>24</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>big</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>25</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>big</td>
<td>med</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>26</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>big</td>
<td>high</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>27</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>2</td>
<td>small</td>
<td>low</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>28</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>2</td>
<td>small</td>
<td>med</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>29</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>2</td>
<td>small</td>
<td>high</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>30</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>2</td>
<td>med</td>
<td>low</td>
<td>unacc</td>
<td>3</td>
</tr>
<tr>
<th>31</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>2</td>
<td>med</td>
<td>med</td>
<td>unacc</td>
<td>3</td>
</tr>
<tr>
<th>32</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>2</td>
<td>med</td>
<td>high</td>
<td>unacc</td>
<td>3</td>
</tr>
<tr>
<th>33</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>2</td>
<td>big</td>
<td>low</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>34</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>2</td>
<td>big</td>
<td>med</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>35</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>2</td>
<td>big</td>
<td>high</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>36</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>4</td>
<td>small</td>
<td>low</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>37</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>4</td>
<td>small</td>
<td>med</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>38</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>4</td>
<td>small</td>
<td>high</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>39</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>4</td>
<td>med</td>
<td>low</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>40</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>4</td>
<td>med</td>
<td>med</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>41</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>4</td>
<td>med</td>
<td>high</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>42</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>4</td>
<td>big</td>
<td>low</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>43</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>4</td>
<td>big</td>
<td>med</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>44</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>4</td>
<td>big</td>
<td>high</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>45</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>more</td>
<td>small</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>46</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>more</td>
<td>small</td>
<td>med</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>47</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>more</td>
<td>small</td>
<td>high</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>48</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>more</td>
<td>med</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>49</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>more</td>
<td>med</td>
<td>med</td>
<td>unacc</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our clustering is not very accurate, it is clustering the cars into different groups than the classes suggest.  Lets look at the distribution of classes to see if we can figure out why this is happening.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [64]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">classes</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">]</span>
<span class="n">classes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[64]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>unacc    1210
acc       384
good       69
vgood      65
Name: acc, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The classes in the dataset aren't evenly represented. Lets look at the cars that are classed as 'vgood' and 'good' and see what type of clusters they're put into.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [74]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"vgood clusters"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'vgood'</span><span class="p">][</span><span class="s1">'cluster'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>  <span class="c1">#get the frequency of each value in the 'cluster' attribute</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">good clusters"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'good'</span><span class="p">][</span><span class="s1">'cluster'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>  <span class="c1">#get the frequency of each value in the 'cluster' attribute</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>vgood clusters
1    35
2    30
Name: cluster, dtype: int64

good clusters
2    36
1    33
Name: cluster, dtype: int64
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>All of the cars under the 'vgood' and 'good' class are being put into clusters 1 and 2.  This is some good news, maybe our clustering algorithm is doing something right, at least there are only two clusters in these two groups.  Lets look at the other two groups with more elements to see what their clustering looks like.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [75]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"acc clusters"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'acc'</span><span class="p">][</span><span class="s1">'cluster'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>  <span class="c1">#get the frequency of each value in the 'cluster' attribute</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">unacc clusters"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'unacc'</span><span class="p">][</span><span class="s1">'cluster'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>  <span class="c1">#get the frequency of each value in the 'cluster' attribute</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>acc clusters
2    198
1    186
Name: cluster, dtype: int64

unacc clusters
0    384
1    322
2    312
3    192
Name: cluster, dtype: int64
</pre>
</div>
</div>
</div>
</div>
</div>This isn't good news, we were hoping to see different clusters than we got from 'vgood' and 'good.  It's likely that the clustering algorithm is finding different correlations in the data that aren't in line with the class.  Lets look at all the '1' clusters since they are represented in every class.  Maybe we can find something to explain why the clusters are different than the class.
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [79]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cluster_1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'cluster'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>   <span class="c1">#get only the datapoints with cluster value of 1</span>
<span class="n">cluster_1</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[79]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>price</th>
<th>maint</th>
<th>doors</th>
<th>ppl</th>
<th>lug</th>
<th>safe</th>
<th>acc</th>
<th>cluster</th>
</tr>
</thead>
<tbody>
<tr>
<th>18</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>small</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>19</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>small</td>
<td>med</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>20</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>small</td>
<td>high</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>21</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>med</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>22</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>med</td>
<td>med</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>23</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>med</td>
<td>high</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>24</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>big</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>25</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>big</td>
<td>med</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>26</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>big</td>
<td>high</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>45</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>more</td>
<td>small</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>46</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>more</td>
<td>small</td>
<td>med</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>47</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>more</td>
<td>small</td>
<td>high</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>48</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>more</td>
<td>med</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>49</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>more</td>
<td>med</td>
<td>med</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>50</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>more</td>
<td>med</td>
<td>high</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>51</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>more</td>
<td>big</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>52</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>more</td>
<td>big</td>
<td>med</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>53</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>more</td>
<td>big</td>
<td>high</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>72</th>
<td>vhigh</td>
<td>vhigh</td>
<td>4</td>
<td>more</td>
<td>small</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>73</th>
<td>vhigh</td>
<td>vhigh</td>
<td>4</td>
<td>more</td>
<td>small</td>
<td>med</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>74</th>
<td>vhigh</td>
<td>vhigh</td>
<td>4</td>
<td>more</td>
<td>small</td>
<td>high</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>75</th>
<td>vhigh</td>
<td>vhigh</td>
<td>4</td>
<td>more</td>
<td>med</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>76</th>
<td>vhigh</td>
<td>vhigh</td>
<td>4</td>
<td>more</td>
<td>med</td>
<td>med</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>77</th>
<td>vhigh</td>
<td>vhigh</td>
<td>4</td>
<td>more</td>
<td>med</td>
<td>high</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>78</th>
<td>vhigh</td>
<td>vhigh</td>
<td>4</td>
<td>more</td>
<td>big</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>79</th>
<td>vhigh</td>
<td>vhigh</td>
<td>4</td>
<td>more</td>
<td>big</td>
<td>med</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>80</th>
<td>vhigh</td>
<td>vhigh</td>
<td>4</td>
<td>more</td>
<td>big</td>
<td>high</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>99</th>
<td>vhigh</td>
<td>vhigh</td>
<td>5more</td>
<td>more</td>
<td>small</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>100</th>
<td>vhigh</td>
<td>vhigh</td>
<td>5more</td>
<td>more</td>
<td>small</td>
<td>med</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>101</th>
<td>vhigh</td>
<td>vhigh</td>
<td>5more</td>
<td>more</td>
<td>small</td>
<td>high</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1644</th>
<td>low</td>
<td>low</td>
<td>2</td>
<td>more</td>
<td>big</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>1645</th>
<td>low</td>
<td>low</td>
<td>2</td>
<td>more</td>
<td>big</td>
<td>med</td>
<td>good</td>
<td>1</td>
</tr>
<tr>
<th>1646</th>
<td>low</td>
<td>low</td>
<td>2</td>
<td>more</td>
<td>big</td>
<td>high</td>
<td>vgood</td>
<td>1</td>
</tr>
<tr>
<th>1665</th>
<td>low</td>
<td>low</td>
<td>3</td>
<td>more</td>
<td>small</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>1666</th>
<td>low</td>
<td>low</td>
<td>3</td>
<td>more</td>
<td>small</td>
<td>med</td>
<td>acc</td>
<td>1</td>
</tr>
<tr>
<th>1667</th>
<td>low</td>
<td>low</td>
<td>3</td>
<td>more</td>
<td>small</td>
<td>high</td>
<td>good</td>
<td>1</td>
</tr>
<tr>
<th>1668</th>
<td>low</td>
<td>low</td>
<td>3</td>
<td>more</td>
<td>med</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>1669</th>
<td>low</td>
<td>low</td>
<td>3</td>
<td>more</td>
<td>med</td>
<td>med</td>
<td>good</td>
<td>1</td>
</tr>
<tr>
<th>1670</th>
<td>low</td>
<td>low</td>
<td>3</td>
<td>more</td>
<td>med</td>
<td>high</td>
<td>vgood</td>
<td>1</td>
</tr>
<tr>
<th>1671</th>
<td>low</td>
<td>low</td>
<td>3</td>
<td>more</td>
<td>big</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>1672</th>
<td>low</td>
<td>low</td>
<td>3</td>
<td>more</td>
<td>big</td>
<td>med</td>
<td>good</td>
<td>1</td>
</tr>
<tr>
<th>1673</th>
<td>low</td>
<td>low</td>
<td>3</td>
<td>more</td>
<td>big</td>
<td>high</td>
<td>vgood</td>
<td>1</td>
</tr>
<tr>
<th>1692</th>
<td>low</td>
<td>low</td>
<td>4</td>
<td>more</td>
<td>small</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>1693</th>
<td>low</td>
<td>low</td>
<td>4</td>
<td>more</td>
<td>small</td>
<td>med</td>
<td>acc</td>
<td>1</td>
</tr>
<tr>
<th>1694</th>
<td>low</td>
<td>low</td>
<td>4</td>
<td>more</td>
<td>small</td>
<td>high</td>
<td>good</td>
<td>1</td>
</tr>
<tr>
<th>1695</th>
<td>low</td>
<td>low</td>
<td>4</td>
<td>more</td>
<td>med</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>1696</th>
<td>low</td>
<td>low</td>
<td>4</td>
<td>more</td>
<td>med</td>
<td>med</td>
<td>good</td>
<td>1</td>
</tr>
<tr>
<th>1697</th>
<td>low</td>
<td>low</td>
<td>4</td>
<td>more</td>
<td>med</td>
<td>high</td>
<td>vgood</td>
<td>1</td>
</tr>
<tr>
<th>1698</th>
<td>low</td>
<td>low</td>
<td>4</td>
<td>more</td>
<td>big</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>1699</th>
<td>low</td>
<td>low</td>
<td>4</td>
<td>more</td>
<td>big</td>
<td>med</td>
<td>good</td>
<td>1</td>
</tr>
<tr>
<th>1700</th>
<td>low</td>
<td>low</td>
<td>4</td>
<td>more</td>
<td>big</td>
<td>high</td>
<td>vgood</td>
<td>1</td>
</tr>
<tr>
<th>1719</th>
<td>low</td>
<td>low</td>
<td>5more</td>
<td>more</td>
<td>small</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>1720</th>
<td>low</td>
<td>low</td>
<td>5more</td>
<td>more</td>
<td>small</td>
<td>med</td>
<td>acc</td>
<td>1</td>
</tr>
<tr>
<th>1721</th>
<td>low</td>
<td>low</td>
<td>5more</td>
<td>more</td>
<td>small</td>
<td>high</td>
<td>good</td>
<td>1</td>
</tr>
<tr>
<th>1722</th>
<td>low</td>
<td>low</td>
<td>5more</td>
<td>more</td>
<td>med</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>1723</th>
<td>low</td>
<td>low</td>
<td>5more</td>
<td>more</td>
<td>med</td>
<td>med</td>
<td>good</td>
<td>1</td>
</tr>
<tr>
<th>1724</th>
<td>low</td>
<td>low</td>
<td>5more</td>
<td>more</td>
<td>med</td>
<td>high</td>
<td>vgood</td>
<td>1</td>
</tr>
<tr>
<th>1725</th>
<td>low</td>
<td>low</td>
<td>5more</td>
<td>more</td>
<td>big</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>1726</th>
<td>low</td>
<td>low</td>
<td>5more</td>
<td>more</td>
<td>big</td>
<td>med</td>
<td>good</td>
<td>1</td>
</tr>
<tr>
<th>1727</th>
<td>low</td>
<td>low</td>
<td>5more</td>
<td>more</td>
<td>big</td>
<td>high</td>
<td>vgood</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>576 rows × 8 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>My first observation is that every element of the ppl attribute is "more" so lets try looking at the value counts for the ppl attribute.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [84]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"Number of passengers, Cluster 1: "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cluster_1</span><span class="p">[</span><span class="s1">'ppl'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>   <span class="c1">#get the frequency of each value in the 'ppl' attribute</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Number of passengers, all Data: "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'ppl'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>   <span class="c1">#get the frequency of each value in the 'ppl' attribute</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of passengers, Cluster 1: 
more    576
Name: ppl, dtype: int64

Number of passengers, all Data: 
more    576
4       576
2       576
Name: ppl, dtype: int64
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The number of passengers is "more" for all of cluster 1, so this could be a big factor for the clustering.  Lets look at some of the other clusters to see if they have a similar trend.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [86]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cluster_2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'cluster'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">cluster_3</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'cluster'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">cluster_0</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'cluster'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Number of passengers, Cluster 2: "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cluster_2</span><span class="p">[</span><span class="s1">'ppl'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>   <span class="c1">#get the frequency of each value in the 'ppl' attribute</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Number of passengers, Cluster 3: "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cluster_3</span><span class="p">[</span><span class="s1">'ppl'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>   <span class="c1">#get the frequency of each value in the 'ppl' attribute</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Number of passengers, Cluster 0: "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cluster_0</span><span class="p">[</span><span class="s1">'ppl'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>   <span class="c1">#get the frequency of each value in the 'ppl' attribute</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of passengers, Cluster 2: 
4    576
Name: ppl, dtype: int64

Number of passengers, Cluster 3: 
2    192
Name: ppl, dtype: int64

Number of passengers, Cluster 0: 
2    384
Name: ppl, dtype: int64
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It seems like our hypothesis was correct, the clustering algorithm grouped the cars primarily by number of passengers.  It is likely that the only reason there are '2' passengers in cluster 3 and 0 is that it had to split it 4 times, but there are only 3 valus for number of passengers.  This could be because the distribution of the number of passengers was so even between the values.  Lets look at the distribution of values in the other attributes to see if they are also evenly distributed.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [87]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Buying Price: "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'price'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>   <span class="c1">#get the frequency of values</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Maintanance Price: "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'maint'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>   <span class="c1">#get the frequency of values</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Number of doors: "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'doors'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>   <span class="c1">#get the frequency of values</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Luggage room: "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'lug'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>   <span class="c1">#get the frequency of values</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Safety: "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'safe'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>   <span class="c1">#get the frequency of values</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>
Buying Price: 
vhigh    432
low      432
high     432
med      432
Name: price, dtype: int64

Maintanance Price: 
vhigh    432
low      432
high     432
med      432
Name: maint, dtype: int64

Number of doors: 
4        432
2        432
5more    432
3        432
Name: doors, dtype: int64

Luggage room: 
small    576
med      576
big      576
Name: lug, dtype: int64

Safety: 
low     576
high    576
med     576
Name: safe, dtype: int64
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>All of the attributes have even represented, so its interesting that the clustering algorithm decided to cluster based primarily on the number of passengers.  Lets try running the clustering algorithm again with a different random seed and see if it does the same thing.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [89]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import the kmeans clustering model.</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="k">import</span> <span class="n">KMeans</span>

<span class="c1"># Initialize the model with 2 parameters -- number of clusters and random state.</span>
<span class="n">kmeans_model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="c1"># Fit the model using the good columns.</span>
<span class="n">kmeans_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">onehot_data</span><span class="p">)</span>

<span class="c1"># Get the cluster assignments.</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">kmeans_model</span><span class="o">.</span><span class="n">labels_</span>

<span class="c1">#reset the cluster column of the data</span>
<span class="n">data</span><span class="p">[</span><span class="s1">'cluster'</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[89]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>price</th>
<th>maint</th>
<th>doors</th>
<th>ppl</th>
<th>lug</th>
<th>safe</th>
<th>acc</th>
<th>cluster</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>small</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>1</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>small</td>
<td>med</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>2</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>small</td>
<td>high</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>3</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>med</td>
<td>low</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>4</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>med</td>
<td>med</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>5</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>med</td>
<td>high</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>6</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>big</td>
<td>low</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>7</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>big</td>
<td>med</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>8</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>big</td>
<td>high</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>9</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>4</td>
<td>small</td>
<td>low</td>
<td>unacc</td>
<td>3</td>
</tr>
<tr>
<th>10</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>4</td>
<td>small</td>
<td>med</td>
<td>unacc</td>
<td>3</td>
</tr>
<tr>
<th>11</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>4</td>
<td>small</td>
<td>high</td>
<td>unacc</td>
<td>3</td>
</tr>
<tr>
<th>12</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>4</td>
<td>med</td>
<td>low</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>13</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>4</td>
<td>med</td>
<td>med</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>14</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>4</td>
<td>med</td>
<td>high</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>15</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>4</td>
<td>big</td>
<td>low</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>16</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>4</td>
<td>big</td>
<td>med</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>17</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>4</td>
<td>big</td>
<td>high</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>18</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>small</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>19</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>small</td>
<td>med</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>20</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>small</td>
<td>high</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>21</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>med</td>
<td>low</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>22</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>med</td>
<td>med</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>23</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>med</td>
<td>high</td>
<td>unacc</td>
<td>2</td>
</tr>
<tr>
<th>24</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>big</td>
<td>low</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>25</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>big</td>
<td>med</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>26</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>more</td>
<td>big</td>
<td>high</td>
<td>unacc</td>
<td>0</td>
</tr>
<tr>
<th>27</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>2</td>
<td>small</td>
<td>low</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>28</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>2</td>
<td>small</td>
<td>med</td>
<td>unacc</td>
<td>1</td>
</tr>
<tr>
<th>29</th>
<td>vhigh</td>
<td>vhigh</td>
<td>3</td>
<td>2</td>
<td>small</td>
<td>high</td>
<td>unacc</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From looking at this run of the clustering algorithm it seems that the luggage is the deciding factor for how the set is clustered.  Lets look at the luggage size value counts for each cluster.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [90]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cluster_0</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'cluster'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">cluster_1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'cluster'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">cluster_2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'cluster'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">cluster_3</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'cluster'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Luggage Space, Cluster 0: "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cluster_0</span><span class="p">[</span><span class="s1">'lug'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>   <span class="c1">#get the frequency of each value in the 'ppl' attribute</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Luggage Space, Cluster 1: "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cluster_1</span><span class="p">[</span><span class="s1">'lug'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>   <span class="c1">#get the frequency of each value in the 'ppl' attribute</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Luggage Space, Cluster 2: "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cluster_2</span><span class="p">[</span><span class="s1">'lug'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>   <span class="c1">#get the frequency of each value in the 'ppl' attribute</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Luggage Space, Cluster 3: "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cluster_3</span><span class="p">[</span><span class="s1">'lug'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>   <span class="c1">#get the frequency of each value in the 'ppl' attribute</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>
Luggage Space, Cluster 0: 
big    576
Name: lug, dtype: int64

Luggage Space, Cluster 1: 
small    384
Name: lug, dtype: int64

Luggage Space, Cluster 2: 
med    576
Name: lug, dtype: int64

Luggage Space, Cluster 3: 
small    192
Name: lug, dtype: int64
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We were right, the clusters are being decided by luggage space now.  Since each attribute has such an even representation, the clustering algorithm is just picking one to focus on based on random chance.  Its likely due to the even distribution of each attribute.  That is very unnatural for a real dataset to have, for each attribute to have the same number of each value.</p>
<p>Lets try running this dataset through some predictors to see if we can accurately predict the class.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [132]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">onehot_data</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1">#add class onto onehot encoded attributes</span>

<span class="n">onehot_data</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">]</span> <span class="o">=</span> <span class="n">onehot_data</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'category'</span><span class="p">)</span>  <span class="c1">#change to category datatype</span>
<span class="n">onehot_data</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">]</span> <span class="o">=</span> <span class="n">onehot_data</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span>  <span class="c1">#change to int code</span>

<span class="c1"># Generate the training set.  Set random_state to be able to replicate results.</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">onehot_data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Select anything not in the training set and put it in the testing set.</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">onehot_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">onehot_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span>

<span class="c1"># Get all the columns from the dataframe.</span>
<span class="n">columns</span> <span class="o">=</span> <span class="n">onehot_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="c1"># Filter the columns to remove ones we don't want.</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">"acc"</span><span class="p">]]</span>

<span class="c1"># Store the variable we'll be predicting on.</span>
<span class="n">target</span> <span class="o">=</span> <span class="s2">"acc"</span>


<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span>

<span class="c1"># Initialize the model with some parameters.</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Fit the model to the data.</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">columns</span><span class="p">],</span> <span class="n">train</span><span class="p">[</span><span class="n">target</span><span class="p">])</span>
<span class="c1"># Make predictions.</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">columns</span><span class="p">])</span>

<span class="c1">#add the prediction column onto the test data to compare with actual class</span>
<span class="n">test</span><span class="p">[</span><span class="s1">'prediction'</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictions</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Users\Asus\Anaconda3\lib\site-packages\ipykernel\__main__.py:30: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We changed the class to a categorical variable and then encoded it as an integer from [0,3].  Then we split the data into training and test data using random sampling.  Then we gathered all the columns that weren't the class.  We imported sklearn RandomForestClassifier and fit a model with our training data.  Then we used that model to predict our test data without the class in it.  Finally, we added on a column to the end of test data to represent the predictions.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [134]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#calculate percentage of correct classifications</span>
<span class="n">num_correct</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">],</span><span class="n">test</span><span class="p">[</span><span class="s1">'prediction'</span><span class="p">]):</span>
    <span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="n">p</span><span class="p">):</span>
        <span class="n">num_correct</span> <span class="o">+=</span> <span class="mi">1</span>
        
<span class="n">percent_correct</span> <span class="o">=</span> <span class="n">num_correct</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Percent Classified Correctly: </span><span class="si">%.2f%%</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">percent_correct</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Percent Classified Correctly: 100.00%
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We compared the predicted class with the actual class and we got 100% accuracy.  That is good news for this dataset, it seems that the data really is representative of the class.  Our k-means clustering didn't show this, so maybe k-means clustering isn't the right clustering algorithm to use.  This is likely because k-means is a linear clustering algorithm, and our classes are defined in a non-linear fashion.  Lets use a different clustering algorithm and see if we get better results.  Our classes are clearly well defined since we got 100% accuracy, we must be able to find a clustering algorithm that can match this.</p>
<p>Lets try DBSCAN from the sklearn library which should be good at picking up non-linear clusters.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [138]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#remake onehot_data for clustering</span>
<span class="n">onehot_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data_noclass</span><span class="p">)</span>

<span class="c1">#import DBSCAN from sklearn</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="k">import</span> <span class="n">DBSCAN</span>

<span class="c1">#create the model with some arbitrary values to start</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1">#fit the model and get clusters</span>
<span class="n">clusters</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">onehot_data</span><span class="p">)</span>

<span class="c1">#set cluster column of data</span>
<span class="n">data</span><span class="p">[</span><span class="s1">'cluster'</span><span class="p">]</span> <span class="o">=</span> <span class="n">clusters</span>

<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[138]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>price</th>
<th>maint</th>
<th>doors</th>
<th>ppl</th>
<th>lug</th>
<th>safe</th>
<th>acc</th>
<th>cluster</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>small</td>
<td>low</td>
<td>unacc</td>
<td>-1</td>
</tr>
<tr>
<th>1</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>small</td>
<td>med</td>
<td>unacc</td>
<td>-1</td>
</tr>
<tr>
<th>2</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>small</td>
<td>high</td>
<td>unacc</td>
<td>-1</td>
</tr>
<tr>
<th>3</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>med</td>
<td>low</td>
<td>unacc</td>
<td>-1</td>
</tr>
<tr>
<th>4</th>
<td>vhigh</td>
<td>vhigh</td>
<td>2</td>
<td>2</td>
<td>med</td>
<td>med</td>
<td>unacc</td>
<td>-1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [139]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">'cluster'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[139]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>-1    1728
Name: cluster, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It seems that our clustering algorithm didn't work.  After trying many different combinations of parameters, (lower min_samples and higher eps should lead to more clusters) I could only ever get 1 cluster, which is useless.  This algorithm must be ill suited for a dataset like this with all categorical data.</p>
<p>I'm starting to think that there isn't a way to cluster this dataset to match the classes.  There is a good chance that the classes are spread out in separate areas of the space.  If this is the case, then there would be no way for an unsupervised learning algorithm to know that these separate areas could be linked as one cluster.</p>
<p>We'll try one more clustering algorithm just to see if we can get some results. We'll try agglomerative clustering which is also good for non-linear clusters.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [166]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="k">import</span> <span class="n">AgglomerativeClustering</span>

<span class="c1">#create the model with 4 clusters</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AgglomerativeClustering</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1">#fit the model and get clusters</span>
<span class="n">clusters</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">onehot_data</span><span class="p">)</span>

<span class="c1">#set cluster column of data</span>
<span class="n">data</span><span class="p">[</span><span class="s1">'cluster'</span><span class="p">]</span> <span class="o">=</span> <span class="n">clusters</span>

<span class="c1">#get clusters and frequency of each</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'cluster'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>0    675
3    351
2    351
1    351
Name: cluster, dtype: int64
unacc    1210
acc       384
good       69
vgood      65
Name: acc, dtype: int64
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This clustering method did not work as we hoped, it didn't come close to the same distribution of classes that we have in the labelled data.  Lets look at the clusters to see which classes are represented in each.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [164]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cluster_0</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'cluster'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">cluster_1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'cluster'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">cluster_2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'cluster'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">cluster_3</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'cluster'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Classes, Cluster 0: "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cluster_0</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>   <span class="c1">#get the frequency of each value in the 'ppl' attribute</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Classes, Cluster 1: "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cluster_1</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>   <span class="c1">#get the frequency of each value in the 'ppl' attribute</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Classes, Cluster 2: "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cluster_2</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>   <span class="c1">#get the frequency of each value in the 'ppl' attribute</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Classes, Cluster 3: "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cluster_3</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>   <span class="c1">#get the frequency of each value in the 'ppl' attribute</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>
Classes, Cluster 0: 
unacc    545
acc      130
Name: acc, dtype: int64

Classes, Cluster 1: 
unacc    216
acc       86
vgood     26
good      23
Name: acc, dtype: int64

Classes, Cluster 2: 
unacc    243
acc      108
Name: acc, dtype: int64

Classes, Cluster 3: 
unacc    206
acc       60
good      46
vgood     39
Name: acc, dtype: int64
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is nowhere near a match for the classes.  But the more I explore this dataset trying to cluster it, the more I think it isn't suited to clustering.  Even though I haven't gained much information about the dataset, I still feel like I've learned something about it.</p>
<p>For my next clustering project I will definitely choose a dataset with continuous variables so that we can get some better results.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="nickareias.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>